{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">

<div class="profile-container">
  <div class="profile-header">
    <div>
      <h2>Profile</h2>
      <p class="subtitle">Manage your account settings and preferences</p>
    </div>
    <button id="editBtn" class="btn-primary">Edit Profile</button>
  </div>

  <div class="profile-grid single">
    <!-- Profile Info FULL WIDTH -->
    <div class="card profile-card">
      <div class="card-header">
        <h3>Personal Information</h3>
        <p>Your personal details and bio</p>
      </div>

      <div class="card-body">

        <!-- VIEW MODE -->
        <div id="viewMode" class="info-section">
          <h3 class="username">{{ user.username }}</h3>
          <p class="user-info"><strong>Full Name:</strong> {{ user.first_name }} {{ user.last_name }}</p>
          <p class="user-info"><strong>Email:</strong> {{ user.email }}</p>
          <p class="user-info"><strong>Location:</strong> {{ profile.location|default:"Not specified" }}</p>
          <p class="user-info"><strong>Bio:</strong> {{ profile.bio|default:"No bio yet." }}</p>

          {% if messages %}
          <div class="messages">
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
          </div>
          {% endif %}
        </div>

        <!-- EDIT MODE -->
        <form id="editMode" method="POST" class="info-section edit-form" style="display:none;">
          {% csrf_token %}

          <div class="form-group">
            <label>Username</label>
            <input type="text" name="username" value="{{ user.username }}" required />
          </div>

          <div class="form-row">
            <div class="form-group half">
              <label>First Name</label>
              <input type="text" name="first_name" value="{{ user.first_name }}" />
            </div>
            <div class="form-group half">
              <label>Last Name</label>
              <input type="text" name="last_name" value="{{ user.last_name }}" />
            </div>
          </div>

          <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" value="{{ user.email }}" />
          </div>

          <div class="form-group">
            <label>Location</label>
            <input type="text" name="location" value="{{ profile.location|default:'' }}" />
          </div>

          <div class="form-group">
            <label>Bio</label>
            <textarea name="bio" rows="4">{{ profile.bio|default:'' }}</textarea>
          </div>

          <div class="button-row">
            <button type="submit" class="btn-primary">Save Changes</button>
            <button type="button" id="cancelBtn" class="btn-outline">Cancel</button>
          </div>
        </form>

      </div>
    </div>
  </div>
</div>

<script>
  const editBtn = document.getElementById("editBtn");
  const cancelBtn = document.getElementById("cancelBtn");
  const viewMode = document.getElementById("viewMode");
  const editMode = document.getElementById("editMode");

  editBtn.addEventListener("click", () => {
    viewMode.style.display = "none";
    editMode.style.display = "block";
    editBtn.style.display = "none";
  });

  cancelBtn.addEventListener("click", () => {
    viewMode.style.display = "block";
    editMode.style.display = "none";
    editBtn.style.display = "inline-block";
  });
</script>
{% endblock %}
